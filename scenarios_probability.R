# checking the final probabilities of DLTs and moderate toxicities
# each matrix represents a scenario



library(markovchain)
  
  
  
  PI1 <-matrix( c( 0.89, 0.08, 0.03, 0.83, 0.12, 0.05, 0.79, 0.14, 0.07, 0.74, 0.16, 0.10, 0.68, 0.19, 0.13,
                   0, 0.87, 0.13,    0, 0.85, 0.15,    0, 0.84, 0.16,    0, 0.82, 0.18,   0, 0.80, 0.20,
                   0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1, 0,    0,    1),
                byrow=T, nrow=3 )
  
  PI2 <-matrix( c(  0.93, 0.06, 0.01, 0.89, 0.08, 0.03, 0.83, 0.12, 0.05, 0.79, 0.14, 0.07, 0.74, 0.16, 0.10,
                    0, 0.89, 0.11, 0, 0.87, 0.13,     0, 0.85, 0.15,    0, 0.84, 0.16,    0, 0.82, 0.18,   
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )
  
  PI3 <-matrix( c(  0.96, 0.03, 0.01, 0.93, 0.06, 0.01, 0.89, 0.08, 0.03, 0.83, 0.12, 0.05, 0.79, 0.14, 0.07,
                    0, 0.96, 0.04, 0, 0.89, 0.11, 0, 0.87, 0.13,     0, 0.85, 0.15,    0, 0.84, 0.16,   
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )
  
  PI4 <-matrix( c(  0.98, 0.02, 0, 0.96, 0.03, 0.01, 0.93, 0.06, 0.01, 0.89, 0.08, 0.03, 0.83, 0.12, 0.05, 
                    0, 0.97, 0.03,    0, 0.96, 0.04, 0, 0.89, 0.11, 0, 0.87, 0.13,     0, 0.85, 0.15,       
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )

  PI5 <-matrix( c(  0.99, .01,  0,    0.98, 0.02, 0, 0.96, 0.03, 0.01, 0.93, 0.06, 0.01, 0.89, 0.08, 0.03,
                    0, 0.98, 0.02, 0, 0.97, 0.03,    0, 0.96, 0.04, 0, 0.89, 0.11, 0, 0.87, 0.13,        
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )

  PI6 <-matrix( c(  0.97, 0.02, 0.01,  0.94, 0.05, 0.01,  0.92, 0.06, 0.02,  0.89, 0.06, 0.05,    0.83, 0.09, 0.08,
                    0, 0.90, 0.10,      0, 0.85, 0.15,      0, 0.75, 0.25,     0, 0.70, 0.30,        0, 0.65, 0.35,
                    0,    0,    1,      0,    0,    1,    0,    0,    1,       0,    0,    1,     0,    0,    1),
                byrow=T, nrow=3 )

  PI7 <-matrix( c(  0.89, 0.09, 0.02, 0.83, 0.12, 0.05, 0.79, 0.14, 0.07, 0.74, 0.17, 0.09, 0.68, 0.20, 0.12,
                    0, 0.98, 0.02,        0, 0.96, 0.04,    0, 0.92, 0.08,      0, 0.89, 0.11,   0, 0.86, 0.14,
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1, 0,    0,    1),
                byrow=T, nrow=3 )

  PI8 <-matrix( c(  0.89, 0.10, 0.01, 0.83, 0.15, 0.02, 0.79, 0.16, 0.05, 0.74, 0.18, 0.08, 0.68, 0.21, 0.11,
                    0, 0.98, 0.02, 0, 0.98, 0.02,        0, 0.96, 0.04,    0, 0.94, 0.06,      0, 0.92, 0.08,
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1, 0,    0,    1),
                byrow=T, nrow=3 )

  PI9 <-matrix( c(  0.89, 0.11, 0, 0.83, 0.16, 0.01, 0.79, 0.19, 0.02, 0.74, 0.21, 0.05, 0.68, 0.25, 0.07,
                    0, 0.98, 0.02, 0, 0.98, 0.02,        0, 0.96, 0.04,    0, 0.96, 0.04,      0, 0.92, 0.08,
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1, 0,    0,    1),
                byrow=T, nrow=3 )

  PI10 <-matrix( c( 0.93, 0.06, 0.01, 0.89, 0.09, 0.02, 0.83, 0.12, 0.05, 0.79, 0.14, 0.07, 0.74, 0.16, 0.10,
                    0, 0.98, 0.02, 0, 0.98, 0.02,        0, 0.96, 0.04,    0, 0.92, 0.08,      0, 0.90, 0.1,
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )

  PI11 <-matrix( c( 0.97, 0.03, 0,  0.95, 0.05, 0,  0.93, 0.07, 0,  0.89, 0.09, 0.02,    0.83, 0.13, 0.04,
                    0, 0.99, 0.01,  0, 0.98, 0.02,    0, 0.98, 0.02,    0, 0.96, 0.04,      0, 0.93, 0.07,
                    0,    0,    1,    0,    0,    1,    0,    0,    1,    0,    0,    1,  0,    0,    1),
                byrow=T, nrow=3 )

  
PI <- PI1 # change with the number of the selected scenario

p1<-NULL
p2<-NULL
for (d in 1:K){
patient <- new("markovchain", states = as.character(1:3),
               transitionMatrix = PI[,(3*d-2):(3*d)],
               name = "Patmarkov")
calc <- c(1,0,0)*(patient^6)
p1 <- c(p1, calc[2]+calc[3])
p2 <- c(p2, calc[3])
}
round(rbind(p1,p2),2)


